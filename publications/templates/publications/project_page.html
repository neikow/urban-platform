{% extends "base.html" %}

{% load wagtailcore_tags wagtailimages_tags i18n %}

{% block content %}
    <article class="mx-4">
        <header class="my-6 md:my-12 lg:my-24 container mx-auto">
            {% include "components/navigation/breadcrumbs.html" with page=page %}
            <h1 class="text-3xl sm:text-4xl lg:text-6xl mb-4 font-extrabold">
                {{ page.title }}
            </h1>
            <div class="flex flex-col-reverse md:flex-row pt-2 md:pt-4 lg:pt-8 gap-4 md:gap-8 lg:gap-16">
                <div class="w-full flex flex-col justify-center items-center gap-4">
                    <span class="badge badge-primary badge-lg">{{ page.get_category_display }}</span>
                    <p class="text-center">
                        {{ page.description }}
                    </p>
                </div>
                {% if page.hero_image %}
                <figure class="w-full">
                    {% image page.hero_image fill-600x400 alt=page.title class="w-full h-56 lg:h-72 object-cover rounded-lg" %}
                </figure>
                {% endif %}
            </div>
        </header>
        <div class="container mx-auto flex flex-col-reverse lg:flex-row gap-4 lg:gap-16 mb-12 lg:mb-24 mt-16 lg:mt-0">
            <main class="flex-1 page-content prose prose-lg max-w-none">
                {% include_block page.content %}

                {% if page.enable_voting %}
                    <div class="divider my-16">
                        <div class="w-16 h-16 aspect-square rounded-full border-2 border-base-content/10 flex items-center justify-center shrink-0">
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-base-content/10">
                                <path d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z" />
                            </svg>
                        </div>
                    </div>
                    <div class="not-prose">
                        {% include "publications/components/vote_form.html" with page=page %}
                    </div>
                {% endif %}
            </main>
            <aside class="w-full lg:w-xs lg:card lg:bg-base-100 lg:p-4 h-min lg:shadow-sm lg:sticky lg:top-20 self-start items-center">
                {% if page.enable_voting %}
                    <a href="#vote-card" class="btn btn-primary btn-block">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z" />
                        </svg>
                        {% trans "Give your opinion" %}
                    </a>
                    <div class="divider my-4"></div>
                {% endif %}
                <div>
                    <h2 class="text-2xl text-start lg:text-lg font-bold mb-4 md:text-center">
                        {% trans "Table of Contents" %}
                    </h2>
                    <div class="relative">
                        <div class="hidden lg:block absolute top-0 left-0 right-0 h-4 bg-gradient-to-b from-base-100 to-transparent z-10 pointer-events-none">
                        </div>
                        <div class="lg:max-h-[400px] lg:overflow-y-auto lg:pb-2 lg:pt-1">
                            {% include "publications/components/project_toc.html" with page=page %}
                        </div>
                        <div class="hidden lg:block absolute bottom-0 left-0 right-0 h-4 bg-gradient-to-t from-base-100 to-transparent z-10 pointer-events-none">
                        </div>
                    </div>
                </div>
            </aside>
        </div>
    </article>
{% endblock content %}
